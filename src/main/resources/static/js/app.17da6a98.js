(function(e){function t(t){for(var r,c,o=t[0],i=t[1],u=t[2],f=0,m=[];f<o.length;f++)c=o[f],Object.prototype.hasOwnProperty.call(s,c)&&s[c]&&m.push(s[c][0]),s[c]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);l&&l(t);while(m.length)m.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,o=1;o<n.length;o++){var i=n[o];0!==s[i]&&(r=!1)}r&&(a.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},s={app:0},a=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=i;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("b3c3"),s=n.n(r);s.a},"0452":function(e,t,n){},"15f1":function(e,t,n){"use strict";var r=n("5fb2"),s=n.n(r);s.a},"18bb":function(e,t,n){"use strict";var r=n("239e"),s=n.n(r);s.a},"239e":function(e,t,n){},"2dd9":function(e,t,n){"use strict";var r=n("4819"),s=n.n(r);s.a},3613:function(e,t,n){},"3ce9":function(e,t,n){},4819:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],c={name:"App",components:{}},o=c,i=(n("034f"),n("2877")),u=Object(i["a"])(o,s,a,!1,null,null,null),l=u.exports,f=n("baac"),m=n("d093");f["a"].init({debug:!0,dependencies:f["a"].useDefaultDependencies({adapter:m["a"]}),callback:function(){}});n("c867");var p=n("1f91"),d=n("14c0"),h=(n("e54f"),n("b05d"));r["a"].use(h["a"],{config:{},components:{},directives:{},plugins:{},lang:{ru:d["a"],eng:p["a"]}});var v=n("2f62"),g=(n("d3b7"),n("ade3")),b=(n("96cf"),n("1da1")),O=(n("99af"),"52.188.70.66"),j="http://".concat(O,":8080"),_="ws://".concat(O,":8188"),S="http://".concat(O,":8080/janus"),E="http://".concat(O,":8080/chat-app");function x(e){return w.apply(this,arguments)}function w(){return w=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/api/room/").concat(t));case 3:if(n=e.sent,!n.ok){e.next=8;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:throw Error(n.statusText);case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",Promise.reject(e.t0));case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),w.apply(this,arguments)}function k(){return C.apply(this,arguments)}function C(){return C=Object(b["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/api/room/create"));case 3:if(t=e.sent,!t.ok){e.next=8;break}return e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 8:e.next=13;break;case 10:return e.prev=10,e.t0=e["catch"](0),e.abrupt("return",Promise.reject(e.t0));case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),C.apply(this,arguments)}var T={SET_ROOM:"SET_ROOM",SET_GUESTS:"SET_GUESTS",REMOVE_GUEST:"REMOVE_GUEST",ADD_GUEST:"ADD_GUEST",SET_USER:"SET_USER",PUSH_NOTIFICATION:"PUSH_NOTIFICATION",DELETE_NOTIFICATION:"DELETE_NOTIFICATION",SET_MESSAGES:"SET_MESSAGES",PUSH_MESSAGE:"PUSH_MESSAGE",SET_USER_MIC_STATE:"SET_USER_MIC_STATE",SET_GUEST_VOICE_STATE:"SET_GUEST_VOICE_STATE"},y=T.SET_ROOM,I={namespaced:!0,state:{room:null},getters:{room:function(e){var t=e.room;return t}},actions:{fetchRoom:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,n.prev=1,n.next=4,x(t);case 4:s=n.sent,r(y,s),n.next=11;break;case 8:return n.prev=8,n.t0=n["catch"](1),n.abrupt("return",Promise.reject("No room"));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()}},mutations:Object(g["a"])({},y,(function(e,t){e.room=t}))},R=I,M=(n("07ac"),n("5530"));function A(e){return U.apply(this,arguments)}function U(){return U=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/api/guest/room/").concat(t));case 3:if(n=e.sent,!n.ok){e.next=8;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:throw Error(n.statusText);case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",Promise.reject(e.t0));case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),U.apply(this,arguments)}function G(e){return P.apply(this,arguments)}function P(){return P=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/api/guest/room/").concat(t,"/create"));case 3:if(n=e.sent,!n.ok){e.next=8;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:throw Error(n.statusText);case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",Promise.reject(e.t0));case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),P.apply(this,arguments)}function N(e){return L.apply(this,arguments)}function L(){return L=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/api/guest/").concat(t));case 3:if(n=e.sent,n.ok){e.next=6;break}throw new Error("Error findUser guest");case 6:return e.abrupt("return",n.json());case 9:return e.prev=9,e.t0=e["catch"](0),e.abrupt("return",Promise.reject(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),L.apply(this,arguments)}var D;n("13d5");function $(e){return e.reduce((function(e,t){return e[t.id]=t,e}),{})}var B,z,q=T.SET_GUESTS,H=T.REMOVE_GUEST,V=T.ADD_GUEST,J=T.SET_GUEST_VOICE_STATE,F={namespaced:!0,state:{guests:{}},getters:{guestList:function(e){var t=e.guests;return Object.values(t)}},actions:{fetchGuests:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,n.prev=1,n.t0=$,n.next=5,A(t);case 5:n.t1=n.sent,s=(0,n.t0)(n.t1),r(q,s),n.next=13;break;case 10:return n.prev=10,n.t2=n["catch"](1),n.abrupt("return",Promise.reject("Something wrong"));case 13:case"end":return n.stop()}}),n,null,[[1,10]])})))()},setGuestList:function(e,t){var n=e.commit;n(q,$(t))},addGuest:function(e,t){var n=e.commit;n(V,t)},removeGuest:function(e,t){var n=e.commit;n(H,t)},setVoiceState:function(e,t){var n=e.commit;n(J,t)}},mutations:(D={},Object(g["a"])(D,q,(function(e,t){e.guests=t})),Object(g["a"])(D,V,(function(e,t){r["a"].set(e.guests,t.id,t)})),Object(g["a"])(D,H,(function(e,t){r["a"].delete(e.guests,t)})),Object(g["a"])(D,J,(function(e,t){var n=t.id,s=t.voiceState,a=Object(M["a"])({},e.guests[n]);a.speaking=s,r["a"].set(e.guests,n,a)})),D)},W=F,Q=(n("c975"),n("a434"),T.PUSH_NOTIFICATION),Z=T.DELETE_NOTIFICATION,Y={namespaced:!0,state:{notifications:[]},getters:{notifications:function(e){var t=e.notifications;return t}},actions:{addNotification:function(e,t){var n=e.commit;n(Q,t)},removeNotification:function(e,t){var n=e.commit;n(Z,t)}},mutations:(B={},Object(g["a"])(B,Q,(function(e,t){e.notifications.push(t)})),Object(g["a"])(B,Z,(function(e,t){var n=e.notifications.indexOf(t);e.notifications.splice(n,1)})),B)},K=Y;function X(e){return ee.apply(this,arguments)}function ee(){return ee=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/api/message/room/").concat(t));case 3:if(n=e.sent,!n.ok){e.next=8;break}return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:throw Error(n.statusText);case 11:return e.prev=11,e.t0=e["catch"](0),e.abrupt("return",Promise.reject(e.t0));case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),ee.apply(this,arguments)}var te,ne=T.SET_MESSAGES,re=T.PUSH_MESSAGE,se={namespaced:!0,state:{messages:[]},getters:{messageList:function(e){var t=e.messages;return t}},actions:{fetchMessages:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,n.prev=1,n.next=4,X(t);case 4:s=n.sent,r(ne,s),n.next=11;break;case 8:return n.prev=8,n.t0=n["catch"](1),n.abrupt("return",Promise.reject("Something wrong"));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()},addMessage:function(e,t){var n=e.commit;n(re,t)}},mutations:(z={},Object(g["a"])(z,ne,(function(e,t){e.messages=t})),Object(g["a"])(z,re,(function(e,t){e.messages.push(t)})),z)},ae=se,ce=T.SET_USER,oe=T.SET_USER_MIC_STATE,ie={namespaced:!0,state:{user:{}},getters:{user:function(e){var t=e.user;return t}},actions:{fetchUser:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function n(){var r,s,a,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.commit,s=e.dispatch,n.prev=1,a=localStorage.getItem("".concat(t,"_USER_ID")),a){n.next=14;break}return n.prev=4,n.next=7,s("createUser",t);case 7:n.next=12;break;case 9:return n.prev=9,n.t0=n["catch"](4),n.abrupt("return",Promise.reject(n.t0));case 12:n.next=18;break;case 14:return n.next=16,N(a);case 16:c=n.sent,r(ce,Object(M["a"])(Object(M["a"])({},c),{},{speaking:!1}));case 18:n.next=30;break;case 20:return n.prev=20,n.t1=n["catch"](1),n.prev=22,n.next=25,s("createUser",t);case 25:n.next=30;break;case 27:return n.prev=27,n.t2=n["catch"](22),n.abrupt("return",Promise.reject(n.t2));case 30:case"end":return n.stop()}}),n,null,[[1,20],[4,9],[22,27]])})))()},createUser:function(e,t){return Object(b["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,n.prev=1,n.next=4,G(t);case 4:s=n.sent,localStorage.setItem("".concat(t,"_USER_ID"),s.id),r(ce,Object(M["a"])(Object(M["a"])({},s),{},{speaking:!1})),n.next=12;break;case 9:return n.prev=9,n.t0=n["catch"](1),n.abrupt("return",Promise.reject(n.t0));case 12:case"end":return n.stop()}}),n,null,[[1,9]])})))()},setMicState:function(e,t){var n=e.commit;n(oe,t)}},mutations:(te={},Object(g["a"])(te,ce,(function(e,t){e.user=t})),Object(g["a"])(te,oe,(function(e,t){r["a"].set(e.user,"speaking",t)})),te)},ue=ie;r["a"].use(v["a"]);var le={user:ue,room:R,guest:W,message:ae,notifications:K},fe=new v["a"].Store({modules:le}),me=fe,pe=n("8c4f"),de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"room"},[n("audio",{ref:"audioZone",attrs:{autoplay:""}}),n("UserPane",{attrs:{user:e.user},on:{handleChangeMicState:e.changeMicState}}),e.guestList.filter((function(t){return t.id!==e.user.id})).length?n("GuestList"):e._e(),n("router-link",{attrs:{to:{name:"main"}}},[e._v("Выйти")]),n("Notifications"),n("Chat",{staticStyle:{position:"absolute",bottom:"0",left:"0",right:"0",width:"100%","box-sizing":"border-box"}})],1)},he=[],ve=n("d4ec"),ge=n("bee2"),be=n("cc7d"),Oe=n.n(be),je=n("c6e1"),_e=n.n(je);n("b0c0");function Se(e){return Ee.apply(this,arguments)}function Ee(){return Ee=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=me.dispatch,e.next=3,JSON.parse(t.body);case 3:r=e.sent,n("guest/addGuest",r),n("notifications/addNotification",{msg:"".concat(r.name," подключился к комнате!"),type:"success"});case 6:case"end":return e.stop()}}),e)}))),Ee.apply(this,arguments)}function xe(e){return we.apply(this,arguments)}function we(){return we=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=me.dispatch,e.next=3,JSON.parse(t.body);case 3:r=e.sent,n("guest/removeGuest",r.id),n("notifications/addNotification",{msg:"".concat(r.name," покинул комнату."),type:"success"});case 6:case"end":return e.stop()}}),e)}))),we.apply(this,arguments)}function ke(e){return Ce.apply(this,arguments)}function Ce(){return Ce=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=me.dispatch,e.next=3,JSON.parse(t.body);case 3:return r=e.sent,e.next=6,n("message/addMessage",r);case 6:case"end":return e.stop()}}),e)}))),Ce.apply(this,arguments)}var Te=function(){function e(){Object(ve["a"])(this,e),this._stompClient=null,this._socket=null}return Object(ge["a"])(e,[{key:"init",value:function(e,t){var n=this;this._socket=new Oe.a(E),this._stompClient=_e.a.over(this._socket);var r=function(){n._stompClient.subscribe("/queue/guest/".concat(t,"/room/").concat(e,"/guestHasJoined"),Se),n._stompClient.subscribe("/queue/room/".concat(e,"/guestHasLeaved"),xe),n._stompClient.subscribe("/queue/room/".concat(e,"/newMessage"),ke),n._stompClient.send("/app/guest/".concat(t,"/room/").concat(e,"/registerGuest"))},s=function(e){console.error("FAILED WS CONNECTION",e)};this._stompClient.connect({},r,s)}},{key:"sendMessage",value:function(e,t,n){if(null===this._stompClient)throw new Error("Failed message sending");this._stompClient.send("/app/message/room/".concat(e,"/guest/").concat(t,"/sendMessage"),{},n)}},{key:"disconnect",value:function(){null!==this._stompClient&&this._stompClient.disconnect(Object(b["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))))}}]),e}(),ye=new Te,Ie=ye,Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.notifications,(function(e,t){return n("Notification",{key:t,attrs:{notification:e}})})),1)},Me=[],Ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v(" "+e._s(e.notification.msg)+" ")])},Ue=[],Ge={name:"Notification",props:{notification:{Type:Object,required:!0}},mounted:function(){var e=this;setTimeout((function(){return e.removeNotification(e.notification)}),1e4)},methods:Object(M["a"])({},Object(v["b"])("notifications",["removeNotification"]))},Pe=Ge,Ne=Object(i["a"])(Pe,Ae,Ue,!1,null,"00e5df1e",null),Le=Ne.exports,De={name:"Notifications",components:{Notification:Le},computed:Object(M["a"])({},Object(v["c"])("notifications",["notifications"]))},$e=De,Be=Object(i["a"])($e,Re,Me,!1,null,"35232e64",null),ze=Be.exports,qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"guestList ui-element"},e._l(e.guestList.filter((function(t){return t.id!==e.user.id})),(function(e){return n("GuestItem",{key:e.sessionId,attrs:{guest:e}})})),1)},He=[],Ve=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"guest-item"},[r("div",{staticClass:"avatar"},[r("img",{staticClass:"guest-Avatar",class:e.micIsActive,attrs:{src:n("7a4e"),alt:"guest avatar"}})])])},Je=[],Fe={name:"GuestItem",props:{guest:{Type:Object,required:!0}},computed:{micIsActive:function(){return{micActive:this.guest.speaking,micOff:!this.guest.speaking}}}},We=Fe,Qe=(n("18bb"),Object(i["a"])(We,Ve,Je,!1,null,"ca416970",null)),Ze=Qe.exports,Ye={name:"GuestList",components:{GuestItem:Ze},computed:Object(M["a"])(Object(M["a"])({},Object(v["c"])("guest",["guestList"])),Object(v["c"])("user",["user"]))},Ke=Ye,Xe=(n("2dd9"),Object(i["a"])(Ke,qe,He,!1,null,"db2a437c",null)),et=Xe.exports,tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat"},[n("ChatTools",{on:{handleClickHideChat:e.hideChat}}),e.hidden?e._e():n("div",{staticClass:"ui-element user-chat"},[n("MessageList"),n("InputArea",{on:{handleSendMessage:e.sendMessage}})],1)],1)},nt=[],rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-input",{staticClass:"chat-input",attrs:{filled:"",placeholder:"Сообщение..."},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter(t)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})},st=[],at={name:"InputArea",data:function(){return{message:""}},methods:{onEnter:function(){this.$emit("handleSendMessage",this.message),this.message=""}}},ct=at,ot=n("fe09"),it=Object(i["a"])(ct,rt,st,!1,null,"142307a7",null),ut=it.exports;it.options.components=Object.assign(Object.create(it.options.components||null),it.options.components||{},{QInput:ot["b"]});var lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-scroll-area",{ref:"messageList",staticClass:"messageList q-pa-md row justify-center",on:{scroll:e.onScroll}},e._l(e.messageList,(function(e,t){return n("MessageItem",{key:t,staticClass:"q-py-xs",attrs:{message:e}})})),1)},ft=[],mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.fadeStyle},[n("q-chat-message",{attrs:{name:e.message.senderId,avatar:"https://static.thenounproject.com/png/302770-200.png",text:[e.message.message],stamp:e.message.sendDate,sent:e.user.id!==e.message.senderId,"bg-color":e.bgColor}})],1)},pt=[],dt={name:"MessageItem",props:{message:{Type:Object,required:!0}},computed:Object(M["a"])(Object(M["a"])({},Object(v["c"])("user",["user"])),{},{bgColor:function(){return this.user.id===this.message.senderId?"amber-7":"blue-7"},fadeStyle:function(){return{fadeInLeft:this.user.id===this.message.senderId,fadeInRight:this.user.id!==this.message.senderId}}})},ht=dt,vt=(n("b297"),Object(i["a"])(ht,mt,pt,!1,null,"17ff4f94",null)),gt=vt.exports;vt.options.components=Object.assign(Object.create(vt.options.components||null),vt.options.components||{},{QChatMessage:ot["a"]});var bt={name:"MessageList",components:{MessageItem:gt},data:function(){return{firstScroll:!0,currentScrollSize:0,vSize:""}},methods:{onScroll:function(e){this.currentScrollSize!==e.verticalSize&&(this.handleScrollSizeChanged(e),this.currentScrollSize=e.verticalSize)},handleScrollSizeChanged:function(e){this.firstScroll?(this.scrollDown(e.verticalSize),this.firstScroll=!1):this.currentScrollSize===e.verticalPosition+218&&this.scrollDown(e.verticalSize)},scrollDown:function(e){this.$refs.messageList.setScrollPosition(e)}},computed:Object(M["a"])({},Object(v["c"])("message",["messageList"]))},Ot=bt,jt=(n("e9aa"),Object(i["a"])(Ot,lt,ft,!1,null,"1bc93084",null)),_t=jt.exports;jt.options.components=Object.assign(Object.create(jt.options.components||null),jt.options.components||{},{QScrollArea:ot["c"]});var St=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chatTools"},[n("OpenChatButton",{nativeOn:{click:function(t){return e.hideChat(t)}}})],1)},Et=[],xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"openChatButton"},[n("div",{staticClass:"text"},[e._v(" Чат ")]),n("div",{staticClass:"chatIcon"},[n("svg",{attrs:{viewBox:"0 0 16 16",id:"actions--comments",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{"fill-rule":"evenodd",d:"M15 14a1.002 1.002 0 0 1-1.703.71h-.004l-.003-.01-1.704-1.7H3c-1.104 0-2-.9-2-2V3c0-1.1.896-2 2-2h10c1.104 0 2 .9 2 2v11zM5 6c.552 0 1 .45 1 1s-.448 1-1 1-1-.45-1-1 .448-1 1-1zm3 0c.552 0 1 .45 1 1s-.448 1-1 1-1-.45-1-1 .448-1 1-1zm3 0c.552 0 1 .45 1 1s-.448 1-1 1-1-.45-1-1 .448-1 1-1z"}})])])])},wt=[],kt={name:"OpenChatButton"},Ct=kt,Tt=(n("f016"),Object(i["a"])(Ct,xt,wt,!1,null,"169ae0a2",null)),yt=Tt.exports,It={name:"ChatTools",components:{OpenChatButton:yt},methods:{hideChat:function(){this.$emit("handleClickHideChat")}}},Rt=It,Mt=(n("5e5f"),Object(i["a"])(Rt,St,Et,!1,null,"4f675561",null)),At=Mt.exports,Ut={name:"Chat",components:{ChatTools:At,MessageList:_t,InputArea:ut},data:function(){return{hidden:!1}},methods:{sendMessage:function(e){try{Ie.sendMessage(this.roomId,this.userId,e)}catch(t){console.error(t)}},hideChat:function(){this.hidden=!this.hidden}},computed:Object(M["a"])(Object(M["a"])(Object(M["a"])({},Object(v["c"])("room",["room"])),Object(v["c"])("user",["user"])),{},{roomId:function(){return this.room.id},userId:function(){return this.user.id}})},Gt=Ut,Pt=(n("9aed"),Object(i["a"])(Gt,tt,nt,!1,null,"17f986f1",null)),Nt=Pt.exports;n("4160"),n("159b");function Lt(){console.log("CREATED")}function Dt(){console.log("FAILED")}function $t(){console.log("DESTROYED")}var Bt={AUDIO_BRIDGE:"janus.plugin.audiobridge"},zt={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"stun:stun01.sipphone.com"},{urls:"stun:stun.rixtelecom.se"},{urls:"stun:stun.schlund.de"},{urls:"stun:stun.softjoys.com"},{urls:"stun:stun.voipbuster.com"},{urls:"stun:stun.voxgratia.org"},{urls:"stun:stun.voipstunt.com"},{urls:"stun:stun.voiparound.com"},{urls:"stun:stun.xten.com"}]},qt=function(){function e(t,n,r){Object(ve["a"])(this,e),this.janus=new f["a"]({server:[_,S],iseServers:zt,success:t,error:n,destroyed:r}),this._audioBridge=null,this._audioElement=null,this._isWebRtcUp=!1}return Object(ge["a"])(e,[{key:"attachPlugin",value:function(e){var t=this,n=e.roomId,r=e.userId;this.janus.attach({plugin:Bt.AUDIO_BRIDGE,success:function(e){t._audioBridge=e,t._joinRoom(e,{roomId:n,userId:r})},error:function(e){console.error(e)},consentDialog:function(e){console.log(e)},onmessage:function(e,n){t._handleEvent(e),t._handleJsep(n)},onlocalstream:function(e){console.error("Local",e)},onremotestream:function(e){t._audioElement.srcObject=e},oncleanup:function(){},detached:function(){}})}},{key:"startAudioTranslation",value:function(){var e=this;null!==this._audioBridge&&this._audioBridge.createOffer({media:{video:!1,audio:!0},success:function(t){var n={request:"configure",muted:!0};e._audioBridge.send({message:n,jsep:t})},error:function(e){console.error(e)}})}},{key:"configureMicrophoneSettings",value:function(e){if(null!==this._audioBridge){var t=!e,n={request:"configure",muted:t};this._audioBridge.send({message:n})}}},{key:"setAudioElement",value:function(e){this._audioElement=e}},{key:"_joinRoom",value:function(e,t){var n=t.roomId,r=t.userId,s={request:"join",room:n,id:r};e.send({message:s})}},{key:"_handleEvent",value:function(e){console.error(e);var t=e["audiobridge"];if(void 0!==t&&null!==t)switch(t){case"joined":this._handleJoinedEvent();break;case"event":this._handleChangedMicState(e);break}}},{key:"_handleJoinedEvent",value:function(){this._isWebRtcUp||(this._isWebRtcUp=!0,this.startAudioTranslation())}},{key:"_handleJsep",value:function(e){void 0!==e&&null!==e&&this._audioBridge.handleRemoteJsep({jsep:e})}},{key:"_handleChangedMicState",value:function(e){var t=e["participants"];if(null!==t&&void 0!==t){var n=me.dispatch;t.forEach((function(e){var t={id:e.id,voiceState:!e.muted};n("guest/setVoiceState",t)}))}}}]),e}(),Ht=new qt(Lt,Dt,$t),Vt=Ht,Jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"userPane ui-element"},[e._m(0),n("div",{on:{click:e.handleMicClick}},[n("svg",{staticClass:"micIcon",class:e.micIsActive,attrs:{viewBox:"0 0 16 16",id:"wysiwyg--mic",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{"fill-rule":"evenodd",d:"M10 16H6a1 1 0 0 1 0-2h.002c.081 0 .15-.059.163-.139a.165.165 0 0 0-.11-.184L6 13.658A6.006 6.006 0 0 1 2 8V7a1 1 0 0 1 2 0v.979c0 2.208 1.792 4 4 4s4-1.792 4-4V7a1 1 0 0 1 2 0v1a6.006 6.006 0 0 1-4 5.658l-.055.019a.165.165 0 0 0-.11.184c.013.08.082.139.163.139H10a1 1 0 0 1 0 2zm1-13a3.001 3.001 0 0 0-6 0v4.624a3.001 3.001 0 0 0 6 0V3z"}})])])])},Ft=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"avatar"},[r("img",{staticClass:"user-avatar",attrs:{src:n("7a4e"),alt:"guest avatar"}})])}],Wt={name:"UserPane",props:{user:{Type:Object,required:!0}},methods:{handleMicClick:function(){this.$emit("handleChangeMicState")}},computed:{micIsActive:function(){return{micActive:this.user.speaking,micOff:!this.user.speaking}}}},Qt=Wt,Zt=(n("15f1"),Object(i["a"])(Qt,Jt,Ft,!1,null,"679dd565",null)),Yt=Zt.exports,Kt={name:"Room",data:function(){return{isMicOn:!1}},components:{UserPane:Yt,Chat:Nt,GuestList:et,Notifications:ze},mounted:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=e.roomId,t.next=4,e.fetchUser(n);case 4:return t.next=6,e.fetchRoom(n);case 6:return t.next=8,e.fetchGuests(n);case 8:return t.next=10,e.fetchMessages(n);case 10:r=e.user.id,Ie.init(n,r),Vt.setAudioElement(e.$refs.audioZone),Vt.attachPlugin({roomId:n,userId:e.user.id}),Vt.configureMicrophoneSettings(e.isMicOn),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](0),console.error(t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])})))()},destroyed:function(){Ie.disconnect()},watch:{isMicOn:function(e){Vt.configureMicrophoneSettings(e),this.setMicState(e)}},methods:Object(M["a"])(Object(M["a"])(Object(M["a"])(Object(M["a"])(Object(M["a"])({},Object(v["b"])("user",["fetchUser","setMicState"])),Object(v["b"])("guest",["fetchGuests"])),Object(v["b"])("room",["fetchRoom"])),Object(v["b"])("message",["fetchMessages"])),{},{changeMicState:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.isMicOn=!e.isMicOn;case 1:case"end":return t.stop()}}),t)})))()}}),computed:Object(M["a"])(Object(M["a"])(Object(M["a"])(Object(M["a"])({},Object(v["c"])("room",["room"])),Object(v["c"])("user",["user"])),Object(v["c"])("guest",["guestList"])),{},{roomId:function(){return this.$route.params.id}})},Xt=Kt,en=(n("d4e5"),Object(i["a"])(Xt,de,he,!1,null,"1a7ce875",null)),tn=en.exports,nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mainPage"},[n("main",[n("CreateRoomButton",{staticClass:"centered",on:{handleClickButton:e.createRoom}})],1)])},rn=[],sn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"createRoomButton",on:{click:e.onClickButton}},[e._v("Создать комнату")])},an=[],cn={name:"CreateRoomButton",methods:{onClickButton:function(){this.$emit("handleClickButton")}}},on=cn,un=(n("dd92"),Object(i["a"])(on,sn,an,!1,null,"78b4b2dd",null)),ln=un.exports,fn={name:"MainPage",components:{CreateRoomButton:ln},methods:{createRoom:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k();case 3:return n=t.sent,t.next=6,e.$router.push({name:"room",params:{id:n.id}});case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error("Failure room creation");case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}},mn=fn,pn=(n("f287"),Object(i["a"])(mn,nn,rn,!1,null,"44957cdc",null)),dn=pn.exports;r["a"].use(pe["a"]);var hn=[{path:"/room/:id",name:"room",component:tn},{path:"/",name:"main",component:dn}],vn=new pe["a"]({mode:"history",routes:hn}),gn=vn;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(l)},store:me,router:gn}).$mount("#app")},"5e5f":function(e,t,n){"use strict";var r=n("e2b5"),s=n.n(r);s.a},"5fb2":function(e,t,n){},"613c":function(e,t,n){},"644e":function(e,t,n){},"7a4e":function(e,t,n){e.exports=n.p+"img/anon-avatar.cd4da7a9.png"},8036:function(e,t,n){},"9aed":function(e,t,n){"use strict";var r=n("ab16"),s=n.n(r);s.a},ab16:function(e,t,n){},b297:function(e,t,n){"use strict";var r=n("3ce9"),s=n.n(r);s.a},b3c3:function(e,t,n){},c867:function(e,t,n){},d4e5:function(e,t,n){"use strict";var r=n("0452"),s=n.n(r);s.a},dd92:function(e,t,n){"use strict";var r=n("3613"),s=n.n(r);s.a},e2b5:function(e,t,n){},e9aa:function(e,t,n){"use strict";var r=n("613c"),s=n.n(r);s.a},f016:function(e,t,n){"use strict";var r=n("644e"),s=n.n(r);s.a},f287:function(e,t,n){"use strict";var r=n("8036"),s=n.n(r);s.a}});
//# sourceMappingURL=app.17da6a98.js.map